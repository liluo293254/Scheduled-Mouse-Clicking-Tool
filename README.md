# 定时鼠标点击工具

为了玩游戏定时点击领取奖励写着玩的小东西，使用C#开发的Windows桌面应用程序，可以设置倒计时时间，倒计时结束后自动连续点击鼠标左键三次（每次间隔2000毫秒，即2秒）。

## 功能特点

- ✅ 可设置倒计时时间（按分钟计算）
- ✅ 可设置循环次数（1-9999次）
- ✅ 可设置固定点击坐标（X、Y坐标）
- ✅ 支持获取当前鼠标位置快速设置坐标
- ✅ 实时显示倒计时（格式：MM:SS）
- ✅ 显示当前循环进度（当前循环/总循环）
- ✅ 倒计时结束后自动连续执行三次鼠标左键点击（每次间隔2000毫秒，即2秒）
- ✅ 支持多次循环，每次循环结束后自动重新开始倒计时
- ✅ 支持开始/停止操作
- ✅ 执行日志实时显示和自动保存到文件
- ✅ 防止系统休眠功能，确保屏幕关闭时软件仍能正常运行
- ✅ 简洁美观的用户界面

## 系统要求

- Windows 操作系统
- .NET 9.0 或更高版本（或 .NET Framework 4.7.1+）

## 编译和运行

### 使用 Visual Studio

1. 打开 `MouseClickTimer.csproj` 文件
2. 按 F5 运行或点击"启动"按钮

### 使用命令行

```bash
# 编译项目
dotnet build

# 运行程序
dotnet run

# 发布可执行文件
dotnet publish -c Release -r win-x64 --self-contained true
```

## 使用方法

1. 启动程序后，在"倒计时(分钟)"输入框中设置需要倒计时的分钟数（最小1分钟，最大999分钟）
2. 在"循环次数"输入框中设置需要循环的次数（最小1次，最大9999次）
3. 设置固定点击坐标：
   - 可以直接在"点击X坐标"和"点击Y坐标"输入框中输入坐标值（0-9999）
   - 或者点击"获取鼠标位置"按钮，程序会自动获取当前鼠标位置并填入坐标
4. 点击"开始"按钮开始倒计时
4. 程序会实时显示剩余时间（格式：MM:SS）和当前循环进度（当前循环/总循环）
5. 每次倒计时结束后，程序会自动在当前鼠标位置连续执行三次鼠标左键点击（每次点击间隔2000毫秒，即2秒）
6. 如果设置了多次循环，每次点击后会自动重新开始倒计时，直到完成所有循环
7. 所有循环完成后会弹出提示对话框
8. 在倒计时过程中可以随时点击"停止"按钮取消倒计时和循环
9. 所有执行日志会自动保存到程序目录下的 `Logs` 文件夹中，按日期分文件保存
10. 点击"打开日志"按钮可以快速打开日志文件夹查看历史记录

## 注意事项

- 倒计时期间，时间设置和循环次数设置控件会被禁用
- 程序关闭时会自动停止正在运行的倒计时和循环
- 鼠标点击会在设置的固定坐标位置执行，不会移动鼠标到该位置
- 点击坐标是固定的，不受当前鼠标位置影响
- 可以通过"获取鼠标位置"按钮快速设置坐标
- 每次倒计时结束会连续点击三次，每次点击间隔2000毫秒（2秒）
- 循环次数设置为1时，等同于单次执行
- 每次循环之间会自动重新开始倒计时，无需手动操作
- 执行日志会自动保存到 `程序目录/Logs/` 文件夹，文件名格式为 `MouseClickLog_YYYY-MM-DD.txt`
- 日志文件使用UTF-8编码，方便在不同系统上查看
- **防止系统休眠**：任务运行时会自动启用防止系统休眠功能，即使屏幕关闭也能正常运行
- 任务停止或完成后会自动恢复系统休眠设置，不影响系统正常使用

## 技术实现

- 使用 Windows Forms 构建用户界面
- 使用 Timer 控件实现倒计时功能
- 使用 Windows API (`mouse_event`) 模拟鼠标点击操作
- 使用 Windows API (`SetThreadExecutionState`) 防止系统休眠，确保屏幕关闭时也能正常运行
- 日志文件自动保存，按日期分文件存储
